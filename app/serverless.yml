service: formularios-microservice
frameworkVersion: "3"

plugins: ${file(config/serverless/plugins.yaml):local}

provider:
  name: aws
  runtime: nodejs20.x
  stage: ${opt:stage, 'dev'}
  region: us-east-1
  memorySize: 512
  timeout: 30
  
  environment:
    FORMULARIOS_TABLE: formularios-${self:provider.stage}
    STAGE: ${self:provider.stage}
    AWS_REGION: us-east-1

functions: ${file(config/serverless/functions.local.yaml)}

custom:
  esbuild:
    bundle: true
    minify: false
    sourcemap: true
    exclude: 
      - aws-sdk
      - '@aws-sdk/*'
    target: node20
    platform: node
    concurrency: 10
  
  # Configuraci√≥n de serverless-offline
  serverless-offline:
    httpPort: 3000
    host: 0.0.0.0
    useChildProcesses: true
    reloadHandler: true
